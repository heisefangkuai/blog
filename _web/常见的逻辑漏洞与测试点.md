# 常见的逻辑漏洞与测试点

## 短信炸弹、邮箱炸弹

产生漏洞的原因主要是前端做验证，这是因为后端没有对发送手机短信做时间限制。

此漏洞经常发生在需要接受验证码处：

1. 账号注册
2. 账号登录
3. 账号密码找回等

测试方法：

使用burp抓取发送验证码请求的数据表，发送到repeater，然后go go go 看相应信息和手机是否能收到验证码，如果收到验证码就存在此漏洞

## 验证码回传

此漏洞是获取验证码时，验证码直接显示在返回的数据包里了，用户可以通过返回的数据表可查看验证码，使用任意手机号或邮箱注册

此漏洞经常发生在需要接受验证码处：

1. 账号注册
2. 账号登录
3. 账号密码找回等

测试方法：

使用burp抓取发送验证码请求的数据表，发送到repeater，然后go，查看返回的数据包内容是否存在手机收到的验证码

防御方法：

- 如果要进行前端验证的话，需要进行加密。
- 返回的数据包不应该包含验证码，验证方式主要采取后端验证

## 任意手机号注册、邮箱注册

产生漏洞的原因是，未对发送验证码的手机号和提交注册的手机号进行对比。造成了可以用一个存在的手机号（邮箱）接收验证码，然后用注册时换成一个不存在的手机号（邮箱）

此漏洞发生在：

1. 账号注册
2. 账号修改手机号
3. 账号修改邮箱

测试方法：

用自己的手机收到正确验证码，在点击注册时拦截包将手机号改为其他手机号，如果注册了别人的手机号说明存在此漏洞

## 验证码爆破、或绕过

产生漏洞的原因是，未对验证码做次数限制，如正常情况下一个验证码只能使用一次，如果验证码可以重复使用，就可以进行爆破。

此漏洞发生在：

1. 账号登录
2. 账号注册，恶意注册

测试方法：

测试图片验证码、手机验证码、邮箱验证码等，将使用正确密码登录的包再重放一次，如果回显还是正确登录的话说明并没有对验证码进行限制，可以尝试撞库。
